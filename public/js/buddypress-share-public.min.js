let{__,_x,_n,sprintf}=wp.i18n;($=>{$(document).ready(function(){function FindLeftWindowBoundry(){return window.screenLeft||window.screenX||0}function FindTopWindowBoundry(){return window.screenTop||window.screenY||0}$(document).on("click",".bp-share-button",function(e){$("body").addClass("bp-share-popup-active"),$(this).parent().parent().next(".service-buttons").toggle(500),$(this).parent().parent().next().next(".bp-share-service-popup-overlay").length&&$(this).parent().parent().next().next(".bp-share-service-popup-overlay").show(),0<$(".bp-activity-more-options-wrap").length&&!$(".bp-activity-more-options-wrap").hasClass("bp-activity-share-popup-open")&&$(".bp-activity-more-options-wrap").addClass("bp-activity-share-popup-open")}),$(document).on("click",".bp-share-service-popup-overlay",function(e){$(this).hide(),$("body").removeClass("bp-share-popup-active"),$(".service-buttons").hide(),0<$(".bp-activity-more-options-wrap").length&&$(".bp-activity-more-options-wrap").hasClass("bp-activity-share-popup-open")&&$(".bp-activity-more-options-wrap").removeClass("bp-activity-share-popup-open")}),$(document).on("click",".bp-share.has-popup",function(e){var y,display_attr=$(this).attr("attr-display");"no-popup"!=display_attr&&(e.preventDefault(),console.log(display_attr),e=$(this).attr("href"),console.log(FindLeftWindowBoundry(),FindTopWindowBoundry()),display_attr=screen.width/2-350+FindLeftWindowBoundry(),y=screen.height/2-225+FindTopWindowBoundry(),window.open(e,"","height=485,width=700,left="+display_attr+",top="+y))}),$(document).on("click",".bp-cpoy",function(e){e.preventDefault();var e=$(this).data("href"),tempTextarea=$("<textarea>");tempTextarea.val(e),$("body").append(tempTextarea),tempTextarea.select();try{var message=document.execCommand("copy")?__("Copied!","buddypress-share"):__("Copy failed","buddypress-share");console.log(message)}catch(err){console.error(__("Unable to copy","buddypress-share"),err)}tempTextarea.remove();var tooltip=$(this).next();tooltip.removeClass("tooltip-hide"),setTimeout(function(){tooltip.addClass("tooltip-hide")},1e3)}),$("#activity-share-modal #post-in").select2({dropdownParent:$("#activity-share-modal")}),$(document).on("click",".bp-secondary-action.bp-activity-share-button",function(e){e.preventDefault();var activity_li_class,activity_id="",activity_html="",reshare_share_activity=bp_activity_share_vars.reshare_share_activity;$(this).parents(".bp-generic-meta.action").hasClass("photos-meta")||$(this).parents(".bp-generic-meta.action").hasClass("videos-meta")||$(this).parents(".bp-generic-meta.action").hasClass("documents-meta")?(activity_id=$(this).data("activity-id"),$.ajax({url:bp_activity_share_vars.ajax_url,method:"POST",data:{action:"bp_share_get_activity_content",activity_id:activity_id,_ajax_nonce:bp_activity_share_vars.ajax_nonce},dataType:"json",success:function(response){var activity_li_class;""!=(activity_html=response.data.contents)&&(activity_html=$($.parseHTML(activity_html)).filter("#activity-"+activity_id).html(),void 0!==(response=$("#activity-stream ul").attr("class"))&&""!=response||(response="activity-list item-list bp-list"),void 0!==(activity_li_class=$("#activity-stream ul li#activity-"+activity_id).attr("class"))&&""!=activity_li_class||(activity_li_class="activity activity_update activity-item"),$("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").addClass(""),$("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").addClass(response),$("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").html(""),$("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").html('<div class="'+activity_li_class+'">'+activity_html+"</div>"),"parent"==reshare_share_activity&&$("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").find(".activity-reshare-item-container").remove(),$("#activity-share-modal .modal-body .bp-generic-meta.action, #activity-share-modal .modal-body .post-footer, #activity-share-modal .modal-body .activity-comments, #activity-share-modal .modal-body .entry-button-wraper, #activity-share-modal .modal-body .bp-activity-post-footer").remove())}})):(void 0!==$(this).data("post-id")&&""!=$(this).data("post-id")?activity_id=$(this).data("post-id"):(activity_id=$(this).data("activity-id"),activity_html=$("#activity-"+activity_id).html(),"child"==reshare_share_activity&&$("#activity-"+activity_id+" .activity-reshare-item-container").each(function(){activity_id=(activity_id=$(this).attr("id").split("bp-reshare-activity-"))[1],activity_html=$(this).html(),$(this).hasClass("post-reshare-item-container")?$("#bp-reshare-type").val("post_share"):$("#bp-reshare-type").val("activity_share")})),""!=activity_html&&(e=$("#activity-stream ul").attr("class"),activity_li_class=$("#activity-stream ul li#activity-"+activity_id).attr("class"),$("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").addClass(""),$("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").addClass(e),$("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").html(""),$("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").html('<div class="'+activity_li_class+'">'+activity_html+"</div>"),"parent"==reshare_share_activity)&&$("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").find(".activity-reshare-item-container").remove(),$("#activity-share-modal .modal-body .activity-meta, #activity-share-modal .modal-body .post-footer, #activity-share-modal .modal-body .activity-comments, #activity-share-modal .modal-body .entry-button-wraper, #activity-share-modal .modal-body .bp-activity-post-footer").remove()),$("#activity-share-modal").on("shown.bs.modal",function(){$("#activity-share-modal").modal("show")}),$("#bp-reshare-activity-id").val(activity_id)}),$(document).on("click",".bp-activity-share-activity",function(e){e.preventDefault();var e=$("#activity-share-modal #bp-activity-share-text").val(),activity_id=$("#activity-share-modal #bp-reshare-activity-id").val(),activity_user_id=$("#activity-share-modal #bp-reshare-activity-user-id").val(),component=$("#activity-share-modal #bp-reshare-activity-current-component").val(),activity_in=$("#activity-share-modal #post-in").val(),type=$("#activity-share-modal #bp-reshare-type").val(),activity_in_type=$("#activity-share-modal #post-in option:selected").data("type");jQuery.ajax({url:bp_activity_share_vars.ajax_url,method:"POST",data:{action:"bp_activity_create_reshare_ajax",activity_content:e,activity_id:activity_id,activity_user_id:activity_user_id,component:component,activity_in:activity_in,activity_in_type:activity_in_type,type:type,_ajax_nonce:bp_activity_share_vars.ajax_nonce},dataType:"text",success:function(data){$("#activity-share-modal").modal("hide"),$("#activity-share-modal #bp-activity-share-text").val("");var share_count=$("#bp-activity-reshare-count-"+activity_id).html();$("#bp-activity-reshare-count-"+activity_id).html(parseInt(share_count)+parseInt("1")),0!=$("#bp-activity-share-"+activity_id+" .share-count").length&&$("#bp-activity-share-"+activity_id+" .share-count").html(parseInt(share_count)+parseInt("1"))}})}),$(document).on("click",".bp-activity-share-close",function(){$("#activity-share-modal").modal("hide")}),$(document).on("click",".bp-activity-share-dropdown-toggle a.dropdown-toggle",function(e){e.preventDefault();e=$(this).closest(".bp-activity-share-dropdown-toggle");e.siblings(".selected").removeClass("selected"),e.toggleClass("selected")}),$("body").mouseup(function(e){$(".bp-activity-share-dropdown-toggle *").is(e.target)||$(".bp-activity-share-dropdown-toggle").removeClass("selected")}),$(document).on("click",".bp-share-activity-share-to-wrapper .bp-share",function(e){$(this).hasClass("bp-cpoy")||$(".bp-activity-share-dropdown-toggle").removeClass("selected")}),$(document).on("click",".bp-activity-reshare-btn",function(e){e.preventDefault();var e=$(this).data("reshare"),reshareOptionText=$(this).attr("data-title");"my-profile"==e&&(e=0),$("#post-in").val(e).trigger("change"),$("#post-in").next(".select2-container").find(".select2-selection__rendered").text(reshareOptionText)}),$(document).on("click",".bp-activity-reshare-btn",function(e){var reshareOptionTextClass=$(this).attr("data-title").toLowerCase().replace(/\s+/g,"-");$(".activity-share-modal").addClass(reshareOptionTextClass).data("reshareOptionTextClass",reshareOptionTextClass)}),$("body").mouseup(function(e){var container=$(".activity-share-modal"),reshareOptionTextClass=container.data("reshareOptionTextClass");container.is(e.target)||0!==container.has(e.target).length||container.removeClass(reshareOptionTextClass)}),$(".bp-activity-share-activity, .activity-share-modal-close").on("click",function(e){var container=$(".activity-share-modal"),reshareOptionTextClass=container.data("reshareOptionTextClass");e.preventDefault(),container.removeClass(reshareOptionTextClass)}),$(document).ready(function(){function toggleDropdownPosition(){$(".bp-activity-share-dropdown-menu").each(function(){var $dropdown=$(this),windowScrollTop=$(window).scrollTop(),windowHeight=$(window).height();$(document).height()-100<=windowScrollTop+windowHeight?$dropdown.addClass("position-top"):$dropdown.removeClass("position-top")})}$(window).scroll(function(){toggleDropdownPosition()}),toggleDropdownPosition()}),$(document).on("click",".activity-reshare-item-container .activity-read-more a",function(event){var activity_id=$(this).parents(".activity-reshare-item-container").data("bp-activity-id"),target=$(event.target),content=target.closest("div"),readMore=target.closest("span"),target=activity_id;event.preventDefault(),$(readMore).addClass("loading"),bp.Nouveau.ajax({action:"get_single_activity_content",id:target},"activity").done(function(response){$(readMore).removeClass("loading"),content.parent().find(".bp-feedback").length&&content.parent().find(".bp-feedback").remove(),!1===response.success?(content.after(response.data.feedback),content.parent().find(".bp-feedback").hide().fadeIn(300)):$(content).slideUp(300).html(response.data.contents).slideDown(300)})})})})(jQuery);