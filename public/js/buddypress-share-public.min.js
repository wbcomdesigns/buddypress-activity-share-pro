let{__,_x,_n,sprintf}=wp.i18n;(c=>{c(document).ready(function(){function i(){return window.screenLeft||window.screenX||0}function o(){return window.screenTop||window.screenY||0}c(document).on("click",".bp-share-button",function(t){c("body").addClass("bp-share-popup-active"),c(this).parent().parent().next(".service-buttons").toggle(500),c(this).parent().parent().next().next(".bp-share-service-popup-overlay").length&&c(this).parent().parent().next().next(".bp-share-service-popup-overlay").show(),0<c(".bp-activity-more-options-wrap").length&&!c(".bp-activity-more-options-wrap").hasClass("bp-activity-share-popup-open")&&c(".bp-activity-more-options-wrap").addClass("bp-activity-share-popup-open")}),c(document).on("click",".bp-share-service-popup-overlay",function(t){c(this).hide(),c("body").removeClass("bp-share-popup-active"),c(".service-buttons").hide(),0<c(".bp-activity-more-options-wrap").length&&c(".bp-activity-more-options-wrap").hasClass("bp-activity-share-popup-open")&&c(".bp-activity-more-options-wrap").removeClass("bp-activity-share-popup-open")}),c(document).on("click",".bp-share.has-popup",function(t){var a,e=c(this).attr("attr-display");"no-popup"!=e&&(t.preventDefault(),console.log(e),t=c(this).attr("href"),console.log(i(),o()),e=screen.width/2-350+i(),a=screen.height/2-225+o(),window.open(t,"","height=485,width=700,left="+e+",top="+a))}),c(document).on("click",".bp-cpoy",function(t){t.preventDefault();var t=c(this).data("href"),a=c("<textarea>");a.val(t),c("body").append(a),a.select();try{var e=document.execCommand("copy")?__("Copied!","buddypress-share"):__("Copy failed","buddypress-share");console.log(e)}catch(t){console.error(__("Unable to copy","buddypress-share"),t)}a.remove();var i=c(this).next();i.removeClass("tooltip-hide"),setTimeout(function(){i.addClass("tooltip-hide")},1e3)}),c("#activity-share-modal #post-in").select2({dropdownParent:c("#activity-share-modal")}),c(document).on("click",".bp-secondary-action.bp-activity-share-button",function(t){t.preventDefault();var a,e="",i="",o=bp_activity_sjare_vars.reshare_share_activity;c(this).parents(".bp-generic-meta.action").hasClass("photos-meta")||c(this).parents(".bp-generic-meta.action").hasClass("videos-meta")||c(this).parents(".bp-generic-meta.action").hasClass("documents-meta")?(e=c(this).data("activity-id"),c.ajax({url:bp_activity_sjare_vars.ajax_url,method:"POST",data:{action:"bp_share_get_activity_content",activity_id:e,_ajax_nonce:bp_activity_sjare_vars.ajax_nonce},dataType:"json",success:function(t){var a;""!=(i=t.data.contents)&&(i=c(c.parseHTML(i)).filter("#activity-"+e).html(),void 0!==(t=c("#activity-stream ul").attr("class"))&&""!=t||(t="activity-list item-list bp-list"),void 0!==(a=c("#activity-stream ul li#activity-"+e).attr("class"))&&""!=a||(a="activity activity_update activity-item"),c("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").addClass(""),c("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").addClass(t),c("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").html(""),c("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").html('<div class="'+a+'">'+i+"</div>"),"parent"==o&&c("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").find(".activity-reshare-item-container").remove(),c("#activity-share-modal .modal-body .bp-generic-meta.action, #activity-share-modal .modal-body .post-footer, #activity-share-modal .modal-body .activity-comments, #activity-share-modal .modal-body .entry-button-wraper, #activity-share-modal .modal-body .bp-activity-post-footer").remove())}})):(void 0!==c(this).data("post-id")&&""!=c(this).data("post-id")?e=c(this).data("post-id"):(e=c(this).data("activity-id"),i=c("#activity-"+e).html(),"child"==o&&c("#activity-"+e+" .activity-reshare-item-container").each(function(){e=(e=c(this).attr("id").split("bp-reshare-activity-"))[1],i=c(this).html(),c(this).hasClass("post-reshare-item-container")?c("#bp-reshare-type").val("post_share"):c("#bp-reshare-type").val("activity_share")})),""!=i&&(t=c("#activity-stream ul").attr("class"),a=c("#activity-stream ul li#activity-"+e).attr("class"),c("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").addClass(""),c("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").addClass(t),c("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").html(""),c("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").html('<div class="'+a+'">'+i+"</div>"),"parent"==o)&&c("#activity-share-modal .modal-body #bp-activity-share-widget-box-status-header").find(".activity-reshare-item-container").remove(),c("#activity-share-modal .modal-body .activity-meta, #activity-share-modal .modal-body .post-footer, #activity-share-modal .modal-body .activity-comments, #activity-share-modal .modal-body .entry-button-wraper, #activity-share-modal .modal-body .bp-activity-post-footer").remove()),c("#activity-share-modal").on("shown.bs.modal",function(){c("#activity-share-modal").modal("show")}),c("#bp-reshare-activity-id").val(e)}),c(document).on("click",".bp-activity-share-activity",function(t){t.preventDefault();var t=c("#activity-share-modal #bp-activity-share-text").val(),e=c("#activity-share-modal #bp-reshare-activity-id").val(),a=c("#activity-share-modal #bp-reshare-activity-user-id").val(),i=c("#activity-share-modal #bp-reshare-activity-current-component").val(),o=c("#activity-share-modal #post-in").val(),s=c("#activity-share-modal #bp-reshare-type").val(),r=c("#activity-share-modal #post-in option:selected").data("type");jQuery.ajax({url:bp_activity_sjare_vars.ajax_url,method:"POST",data:{action:"bp_activity_create_reshare_ajax",activity_content:t,activity_id:e,activity_user_id:a,component:i,activity_in:o,activity_in_type:r,type:s,_ajax_nonce:bp_activity_sjare_vars.ajax_nonce},dataType:"text",success:function(t){c("#activity-share-modal").modal("hide"),c("#activity-share-modal #bp-activity-share-text").val("");var a=c("#bp-activity-reshare-count-"+e).html();c("#bp-activity-reshare-count-"+e).html(parseInt(a)+parseInt("1")),0!=c("#bp-activity-share-"+e+" .share-count").length&&c("#bp-activity-share-"+e+" .share-count").html(parseInt(a)+parseInt("1"))}})}),c(document).on("click",".bp-activity-share-close",function(){c("#activity-share-modal").modal("hide")}),c(document).on("click",".bp-activity-share-dropdown-toggle a.dropdown-toggle",function(t){t.preventDefault();t=c(this).closest(".bp-activity-share-dropdown-toggle");t.siblings(".selected").removeClass("selected"),t.toggleClass("selected")}),c("body").mouseup(function(t){c(".bp-activity-share-dropdown-toggle *").is(t.target)||c(".bp-activity-share-dropdown-toggle").removeClass("selected")}),c(document).on("click",".bp-share-activity-share-to-wrapper .bp-share",function(t){c(this).hasClass("bp-cpoy")||c(".bp-activity-share-dropdown-toggle").removeClass("selected")}),c(document).on("click",".bp-activity-reshare-btn",function(t){t.preventDefault();var t=c(this).data("reshare"),a=c(this).attr("data-title");"my-profile"==t&&(t=0),c("#post-in").val(t).trigger("change"),c("#post-in").next(".select2-container").find(".select2-selection__rendered").text(a)}),c(document).on("click",".bp-activity-reshare-btn",function(t){var a=c(this).attr("data-title").toLowerCase().replace(/\s+/g,"-");c(".activity-share-modal").addClass(a).data("reshareOptionTextClass",a)}),c("body").mouseup(function(t){var a=c(".activity-share-modal"),e=a.data("reshareOptionTextClass");a.is(t.target)||0!==a.has(t.target).length||a.removeClass(e)}),c(".bp-activity-share-activity, .activity-share-modal-close").on("click",function(t){var a=c(".activity-share-modal"),e=a.data("reshareOptionTextClass");t.preventDefault(),a.removeClass(e)}),c(document).ready(function(){function t(){c(".bp-activity-share-dropdown-menu").each(function(){var t=c(this),a=c(window).scrollTop(),e=c(window).height();c(document).height()-100<=a+e?t.addClass("position-top"):t.removeClass("position-top")})}c(window).scroll(function(){t()}),t()}),c(document).on("click",".activity-reshare-item-container .activity-read-more a",function(t){var a=c(this).parents(".activity-reshare-item-container").data("bp-activity-id"),e=c(t.target),i=e.closest("div"),o=e.closest("span"),e=a;t.preventDefault(),c(o).addClass("loading"),bp.Nouveau.ajax({action:"get_single_activity_content",id:e},"activity").done(function(t){c(o).removeClass("loading"),i.parent().find(".bp-feedback").length&&i.parent().find(".bp-feedback").remove(),!1===t.success?(i.after(t.data.feedback),i.parent().find(".bp-feedback").hide().fadeIn(300)):c(i).slideUp(300).html(t.data.contents).slideDown(300)})})})})(jQuery);